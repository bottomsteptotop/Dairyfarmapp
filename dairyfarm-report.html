<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monthly Report - Dairy Farm</title>
<style>
  body { font-family: Arial, sans-serif; background: #fff6f9; text-align: center; }
  header { background: #E91E63; color: white; padding: 15px; font-size: 22px; font-weight: bold; }
  .section { margin: 20px auto; width: 90%; max-width: 500px; background: #fff; border: 1px solid #ddd; border-radius: 6px; padding: 10px; }
  .title { background: #f8e6ec; padding: 5px; font-weight: bold; }
  .entry { border-bottom: 1px solid #ddd; padding: 5px; text-align: left; }
  .deleteBtn { background:#E91E63; color:white; padding:3px 8px; border:none; border-radius:4px; margin-left:5px; }
  .total { font-size: 18px; font-weight: bold; margin-top: 10px; color: #d81b60; }
  a { display: block; margin: 20px auto; padding: 10px; background: #4CAF50; color: white; width: 80%; max-width: 300px; border-radius: 6px; text-decoration: none; font-size: 18px; }
  a:hover { background: #388e3c; }
</style>
</head>
<body>

<header>üìä Monthly Report</header>

<!-- Month Filter -->
<label><b>üìÖ Select Month:</b></label>
<input type="month" id="monthFilter">
<button onclick="filterByMonth()">Filter</button>

<!-- Cows Section -->
<div class="section">
  <div class="title">üêÑ Insemination Records</div>
  <div id="cowList">Loading...</div>
</div>

<!-- Sales Section -->
<div class="section">
  <div class="title">ü•õ Milk Sales Records</div>
  <div id="salesList">Loading...</div>
  <div class="total" id="salesTotal"></div>
</div>

<a href="index.html">‚¨Ö Back to Dashboard</a>

<script>
// Load Data
let cows = JSON.parse(localStorage.getItem("autoEntries")) || [];
let sales = JSON.parse(localStorage.getItem("milkSales")) || [];

// Display Cows
function showCows() {
    const cowDiv = document.getElementById("cowList");
    if (cows.length === 0) { cowDiv.innerHTML = "No records."; return; }
    cowDiv.innerHTML = "";
    cows.forEach((c,i) => {
        cowDiv.innerHTML += `<div class="entry">üêÑ <b>${c.cow}</b> | Insemination: ${c.insemination} | Delivery: ${c.delivery}
        <button class="deleteBtn" onclick="deleteCow(${i})">‚ùå</button></div>`;
    });
}

// Display Sales
function showSales(filterMonth="") {
    const salesDiv = document.getElementById("salesList");
    let totalAmount = 0;
    salesDiv.innerHTML = "";
    let filtered = sales;

    if (filterMonth !== "") {
        filtered = sales.filter(s => s.date && s.date.startsWith(filterMonth));
    }

    if (filtered.length === 0) { salesDiv.innerHTML = "No sales."; document.getElementById("salesTotal").innerText=""; return; }

    filtered.forEach((s,i) => {
        totalAmount += s.total;
        salesDiv.innerHTML += `<div class="entry">üë§ <b>${s.customer}</b> | ${s.quantity}L √ó ‚Çπ${s.price} = ‚Çπ${s.total} ${s.date?`| ${s.date}`:""}
        <button class="deleteBtn" onclick="deleteSale(${i})">‚ùå</button></div>`;
    });
    document.getElementById("salesTotal").innerText = `üí∞ Total Sales: ‚Çπ${totalAmount}`;
}

// Delete Functions
function deleteCow(i){ if(confirm("Delete this cow record?")){ cows.splice(i,1); localStorage.setItem("autoEntries",JSON.stringify(cows)); showCows(); } }
function deleteSale(i){ if(confirm("Delete this sale?")){ sales.splice(i,1); localStorage.setItem("milkSales",JSON.stringify(sales)); showSales(); } }

// Month Filter
function filterByMonth() {
    const m = document.getElementById("monthFilter").value;
    showSales(m);
}

// Initial Load
showCows();
showSales();
</script>

</body>
</html>
