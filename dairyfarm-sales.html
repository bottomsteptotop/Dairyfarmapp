<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Milk Sales - Dairy Farm</title>
<style>
  body { font-family: Arial, sans-serif; background: #eefaff; text-align: center; }
  header { background: #2196F3; color: white; padding: 15px; font-size: 22px; font-weight: bold; }
  form { margin: 20px auto; padding: 15px; background: #f5f5f5; width: 90%; max-width: 400px; border-radius: 8px; }
  input, select { width: 90%; padding: 8px; margin: 8px 0; }
  button { background: #4CAF50; color: white; padding: 8px 15px; border: none; border-radius: 6px; cursor: pointer; }
  button:hover { background: #388e3c; }
  .list { margin-top: 20px; padding: 10px; background: #fff; border: 1px solid #ddd; width: 90%; max-width: 400px; margin: auto; }
  .entry { padding: 5px; border-bottom: 1px solid #ddd; text-align: left; }
  .editBtn { background:#2196F3; margin-left:5px; }
  .deleteBtn { background:#E91E63; margin-left:5px; }
</style>
</head>
<body>

<header>ü•õ Daily Milk Sales (Auto Default Qty)</header>

<h3>‚ûï Set Default Quantity</h3>
<form id="defaultForm">
  <input type="text" id="defCustomer" placeholder="Customer Name" required><br>
  <input type="number" id="defQty" placeholder="Default Quantity (litres)" required><br>
  <label>Default Price:</label><br>
  <select id="defPrice">
    <option value="50">Direct Purchase - ‚Çπ50</option>
    <option value="52">Door Delivery - ‚Çπ52</option>
  </select><br>
  <button type="submit">Save Default</button>
</form>

<h3>‚ûï Add / Edit Sale</h3>
<form id="salesForm">
  <input type="hidden" id="editIndex">
  <input type="date" id="saleDate" required><br>
  <input type="text" id="customer" placeholder="Customer Name" required><br>
  <input type="number" id="quantity" placeholder="Quantity (litres)" required><br>
  <label>Price Type:</label><br>
  <select id="priceType">
    <option value="50">Direct Purchase - ‚Çπ50</option>
    <option value="52">Door Delivery - ‚Çπ52</option>
  </select><br>
  <button type="submit">Save Sale</button>
</form>

<h3>üìã Sales Records</h3>
<div class="list" id="salesList">No sales yet.</div>

<a href="index.html">‚¨Ö Back to Dashboard</a>

<script>
// Load Data
let sales = JSON.parse(localStorage.getItem("milkSales")) || [];
let defaults = JSON.parse(localStorage.getItem("customerDefaults")) || {};

// Show Sales Records
function showSales() {
    const list = document.getElementById("salesList");
    if (sales.length === 0) { list.innerHTML = "No sales yet."; return; }
    list.innerHTML = "";
    sales.forEach((s, i) => {
        list.innerHTML += `<div class="entry">üìÖ ${s.date} | üë§ <b>${s.customer}</b> | ${s.quantity}L √ó ‚Çπ${s.price} = ‚Çπ${s.total}
        <button class="editBtn" onclick="editSale(${i})">üìù Edit</button>
        <button class="deleteBtn" onclick="deleteSale(${i})">‚ùå Delete</button></div>`;
    });
}

// Save Sales to Storage
function saveSales() {
    localStorage.setItem("milkSales", JSON.stringify(sales));
    showSales();
}

// Save Default Quantity
document.getElementById("defaultForm").addEventListener("submit", function(e){
    e.preventDefault();
    const name = document.getElementById("defCustomer").value;
    const qty = parseFloat(document.getElementById("defQty").value);
    const price = parseFloat(document.getElementById("defPrice").value);
    defaults[name] = { qty, price };
    localStorage.setItem("customerDefaults", JSON.stringify(defaults));
    alert("‚úÖ Default set for " + name);
    document.getElementById("defaultForm").reset();
});

// Auto-fill defaults when customer name entered
document.getElementById("customer").addEventListener("input", function(){
    const name = this.value;
    if (defaults[name]) {
        document.getElementById("quantity").value = defaults[name].qty;
        document.getElementById("priceType").value = defaults[name].price;
    }
});

// Add/Edit Sale Entry
document.getElementById("salesForm").addEventListener("submit", function(e){
    e.preventDefault();
    const date = document.getElementById("saleDate").value;
    const customer = document.getElementById("customer").value;
    const quantity = parseFloat(document.getElementById("quantity").value);
    const price = parseFloat(document.getElementById("priceType").value);
    const total = quantity * price;
    const index = document.getElementById("editIndex").value;

    if (index) {
        sales[index] = { date, customer, quantity, price, total };
    } else {
        sales.push({ date, customer, quantity, price, total });
    }

    document.getElementById("editIndex").value = "";
    document.getElementById("salesForm").reset();
    saveSales();
});

// Edit & Delete Functions
function editSale(i) {
    document.getElementById("saleDate").value = sales[i].date;
    document.getElementById("customer").value = sales[i].customer;
    document.getElementById("quantity").value = sales[i].quantity;
    document.getElementById("priceType").value = sales[i].price;
    document.getElementById("editIndex").value = i;
}
function deleteSale(i) {
    if (confirm("Delete this sale record?")) {
        sales.splice(i, 1);
        saveSales();
    }
}

showSales();
</script>

</body>
</html>
